<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS3 Viewer</title>

<style>
body {
    background: #111;
    color: #fff;
    font-family: Arial;
    margin: 0;
    padding: 0;
    text-align: center;
}

#viewer {
    margin-top: 40px;
}

img {
    max-width: 90%;
    max-height: 80vh;
}

#text-view {
    background: #fff;
    color: #000;
    width: 80%;
    margin: 40px auto;
    padding: 20px;
    text-align: left;
    white-space: pre-wrap;
}

#info {
    margin-top: 10px;
    font-size: 14px;
    color: #ccc;
}
</style>

<script>
function getParam(name) {
    var url = window.location.search.substring(1);
    var vars = url.split("&");
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (pair[0] == name) {
            return decodeURIComponent(pair[1]);
        }
    }
    return null;
}

function loadFile() {
    var q = getParam("q");
    if (!q) return;

    var path = "files/" + q;
    var ext = q.split(".").pop().toLowerCase();

    var viewer = document.getElementById("viewer");

    if (ext == "jpg" || ext == "png" || ext == "jpeg" || ext == "gif") {
        var img = document.createElement("img");
        img.src = path;
        viewer.appendChild(img);

        var info = document.createElement("div");
        info.id = "info";
        info.innerHTML = q;
        viewer.appendChild(info);

    } else if (ext == "txt") {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", path, true);
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4) {
                var div = document.createElement("div");
                div.id = "text-view";
                div.textContent = xhr.responseText;
                viewer.appendChild(div);
            }
        };
        xhr.send();

    } else {
        viewer.innerHTML =
            "<p>Archivo:</p>" +
            "<a href='" + path + "' style='color:#4da3ff'>" + q + "</a>";
    }
}

window.onload = loadFile;
</script>
</head>

<body>
<div id="viewer"></div>
</body>
</html>
